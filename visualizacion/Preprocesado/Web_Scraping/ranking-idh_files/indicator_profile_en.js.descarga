function addCommas(x){var parts=x.toString().split('.');parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,',');return parts.join('.');}
function filterJSON(json,key,value){var result=[];for(var indicator in json){if(parseInt(json[indicator][key])===value){result.push(json[indicator]);}}
return result;}
var data;var line=d3.svg.line().x(function(d){return xScale(d.year);}).y(function(d){return yScale(d.value);});var newDict={};var interval;definitions={"a":"Refers to 2004.","b":"Refers to 2001.","c":"Refers to 2005.","d":"Refers to 2002.","e":"Based on cross-country regression.","f":"Data refer to the most recent year available during the period specified.","g":"Estimates modelled by the International Labour Organization.","h":"The natural sex ratio at birth is commonly assumed and empirically confirmed to be 1.05 male births to 1 female birth.","i":"Because data are based on national definitions of what constitutes a city or metropolitan area, cross-country comparison should be made with caution.","j":"Includes Agalega, Rodrigues and Saint Brandon.","k":"Includes Åland Islands.","l":"Includes Svalbard and Jan Mayen Islands.","m":"Includes Christmas Island, Cocos (Keeling) Islands and Norfolk Island.","n":"In calculating the Gender Inequality Index, a value of 0.1 percent was used.","o":"Estimated using the purchasing power parity (PPP) rate and projected growth rate of Spain.","p":"Estimated using the PPP rate and projected growth rate of Spain.","q":"Excludes the 36 special rotating delegates appointed on an ad hoc basis.","r":"Includes Zanzibar.","s":"Includes Sabah and Sarawak.","t":"Includes Nagorno-Karabakh.","u":"Includes Abkhazia and South Ossetia.","v":"Includes East Jerusalem.","w":"Includes Transnistria.","x":"Projections based on medium-fertility variant.","y":"Average score for OECD countries is 493.","z":"Refers to 2009.","aa":"Includes Kosovo.","bb":"Includes Canary Islands, Ceuta and Melilla.","cc":"See http://hdr.undp.org/en/composite/IHDI for the list of surveys used to estimate inequalities.","dd":"Includes Northern Cyprus.","ee":"0.1 or less.","ff":"Because statutory pension ages differ by country, cross-country comparisons should be made with caution.","gg":"An unknown number of refugees and asylum-seekers from South Sudan may be included under data for Sudan.","hh":"May include citizens of South Sudan.","ii":"Because disaggregated income data are not available, data are crudely estimated. See Definitions and Technical note 3 at http://hdr.undp.org/sites/default/files/hdr2018_technical_notes.pdf for details on how the Gender Development Index is calculated.","jj":"In calculating the male HDI value, estimated gross national income per capita is capped at $75,000.","kk":"In calculating the HDI value, GNI per capita is capped at $75,000.","ll":"HDRO estimate based on 2006 Census.","mm":"Value from UNDESA (2011).","nn":"A negative value refers to net official development assistance disbursed by donor countries.","oo":"Less than 0.1.","pp":"Average score for Organisation for Economic Co-operation and Development (OECD) countries is 490.","qq":"Refers to 2011.","rr":"Refers to 2013.","ss":"HDRO calculations based on data from ICPR (2016).","tt":"Data refer to people recognized as refugees under the 1951 UN Convention, the 1967 UN Protocol and the 1969 Organization of African Unity Convention. In the absence of government figures, the Office of the UN High Commissioner for Refugees (UNHCR) has estimated the refugee population in many industrialized countries based on 10 years of individual asylum-seeker recognition.","uu":"Imputed mean years of schooling for Austria.","vv":"Based on data from national statistical office.","ww":"Based on Barro and Lee (2016).","xx":"In calculating the HDI value, expected years of schooling is capped at 18 years.","yy":"For more detailed country notes, see www.prisonstudies.org.","zz":"Data for 1995 are actually data reported for 1997.","aaa":"Uses 'Share of seats in parliament' that refers to 1997.","bbb":"Refers to 2014.","ccc":"Data are average annual estimates for 2010-2015.","ddd":"Includes Crimea.","eee":"HDRO estimate based on data from World Bank (2018b) and United Nations Statistics Division (2018b).","fff":"Based on a cross-country regression and the projected growth rate from UNECLAC (2018).","ggg":"HDRO estimate based on data from World Bank (2018b), United Nations Statistics Division (2018b) and projected growth rates from UNESCWA (2018).","hhh":"Updated by HDRO based on data from UNESCO Institute for Statistics (2018).","iii":"Updated by HDRO based on data from ICF Macro Demographic and Health Surveys for 2006-2017.","jjj":"Updated by HDRO based on Syrian Center for Policy Research (2017).","kkk":"Updated by HDRO using Barro and Lee (2016) estimates.","lll":"Refers to Palestinian refugees under the UNHCR mandate only. Another 5,340,443 Palestinian refugees are under the responsibility of United Nations Relief and Works Agency for Palestinian Refugees in the Near East (UNRWA 2017).","mmm":"Changes in definitions and/or counting rules are reported by the Member State to indicate a break in the time series.","nnn":"Calculated by HDRO from the 2015-2020 period life tables from UNDESA (2017a).","ooo":"Data collection methods, age ranges, sampled women (ever-partnered, ever-married or all women) and definitions of the forms of violence and of perpetrators vary by survey. Thus data are not necessarily comparable across countries.","ppp":"Data refer to a year earlier than 2010.","qqq":"This column is intentionally left without colour because it is meant to provide context for the indicator on change in forest area.","rrr":"Refers to 2015.","sss":"Based on data from OECD (2017a).","ttt":"Data refer to 2016 or the most recent year available.","uuu":"Data are the annual average of projected values for 2015-2020.","vvv":"Based on data from United Nations Children's Fund (UNICEF) Multiple Indicator Cluster Surveys for 2006-2017.","www":"Data are annual average of projections for 2015–2020 based on the medium-fertility variant.","xxx":"Data refer to offences, not victims, of intentional homicide.","yyy":"Data for 2000-2006 refer to offences and data for 2007 onwards refer to victims of intentional homicide.","zzz":"Public institutions only.","aaaa":"Refers only to ISCED levels 1 and 2.","bbbb":"Refers only to ISCED level 3.","cccc":"Refers to West Bank schools only.","dddd":"Refers only to International Standard Classification of Education (ISCED) level 2.","eeee":"There are no private institutions at ISCED level 3.","ffff":"Refers to the adjudicated region of Ciudad Autónoma de Buenos Aires.","gggg":"Refers to the provinces of Beijing, Guangdong, Jiangsu and Shanghai.","hhhh":"Refers to a year between 2006 and 2009.","iiii":"Includes only advanced education.","jjjj":"The trend data used to calculate the change are available at http://hdr.undp.org/en/data.","kkkk":"Data refer to the most recent year for which all three types of expenditure (education, health and military) are available during the period specified.","llll":"Data on government expenditure on education and health are available in tables 8 and 9 and at http://hdr.undp.org/en/data.","mmmm":"Refers to 2016.","nnnn":"Data refer to 2017 or the most recent year available.","oooo":"Data for 2015 and earlier refer to offences of intentional homicide, then victims.","pppp":"Data for 2000-2009 are from the World Health Organization (WHO), data for 2010-2012 represent a break in the time series and data for 2013-2016 are from the Prosecutor-General of the Russian Federation and include victims of attempted homicide.","qqqq":"Estimates of 100 percent are assumed given the completeness of the civil registration system, which registers all vital events (including births).","rrrr":"Refers to 2018.","ssss":"WHO estimate used because other data were unavailable. The Government of the Democratic People’s Republic of Korea does not agree with this estimate.","tttt":"A negative value indicates that inequality declined over the period specified."};fonotes=[""];var notes="";var added=[];var arrAlpha=['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','w','x','y','z'];var count=-1;d3.json("/sites/all/themes/hdr_theme/js/indicators.json",function(fallback){d3.json("/sites/all/themes/hdr_theme/js/bars.json",function(json){d3.json("/sites/all/themes/hdr_theme/js/footnotes.json",function(foot){d3.json("/sites/all/themes/hdr_theme/js/rankiso.json",function(rank){foot.forEach(function(d){d.indicator_id=+d.indicator_id;})
filtered=filterJSON(json,'id',currentIndicator);if(filtered.length==0){filtered=filterJSON(fallback,'id',currentIndicator);}
filterFootnotes=filterJSON(foot,'indicator_id',currentIndicator);indName=[""];indicatorName=filtered[0].indicator;filtered.forEach(function(d){d.id=+d.id;if(currentIndicator==71406||currentIndicator==71506||currentIndicator==71606||currentIndicator==103206||currentIndicator==103606||currentIndicator==103706||currentIndicator==68606||currentIndicator==136906||currentIndicator==137006||currentIndicator==137506||currentIndicator==137906||currentIndicator==138806||currentIndicator==170006||currentIndicator==181606){return d.value=(+Math.round((+d.value+0.00001)*1000)/1000).toFixed(3);}
else if(currentIndicator==169706||currentIndicator==169806||currentIndicator==174406||currentIndicator==49006||currentIndicator==52606){return d.value=(+Math.round((+d.value+0.00001)*1000)/1000).toFixed(2);}
else if(currentIndicator==181406||currentIndicator==177706||currentIndicator==181106||currentIndicator==149406||currentIndicator==141706||currentIndicator==146206||currentIndicator==176606||currentIndicator==176806||currentIndicator==176906||currentIndicator==177006||currentIndicator==123506||currentIndicator==123606||currentIndicator==128106||currentIndicator==128306||currentIndicator==111106||currentIndicator==136706||currentIndicator==133006||currentIndicator==63206||currentIndicator==63306||currentIndicator==63406||currentIndicator==64306||currentIndicator==64406||currentIndicator==89006||currentIndicator==45806||currentIndicator==46206||currentIndicator==57806||currentIndicator==57906){return d.value=(+Math.round((+d.value+0.00001)*1000)/1000).toFixed(0);}
else{return d.value=(+Math.round((+d.value+0.00001)*1000)/1000).toFixed(1);}
d.year=+d.year;});var joinData=alasql('SELECT * FROM ? rank JOIN ? filtered USING iso3',[filtered,rank]);joinData.sort(function(a,b){return d3.ascending(a.country,b.country);});if(currentIndicator==102006){joinData.forEach(function(d){d.value=addCommas(d.value);})};function merge(joinData,filterFootnotes){function makeObj(a){obj[a.iso3]=obj[a.iso3]||{};obj[a.iso3][a.year]=obj[a.iso3][a.year]||{};Object.keys(a).forEach(function(k){obj[a.iso3][a.year][k]=a[k];});}
var array=[],obj={};joinData.forEach(makeObj);filterFootnotes.forEach(makeObj);Object.keys(obj).forEach(function(k){Object.keys(obj[k]).forEach(function(kk){array.push(obj[k][kk]);});});return array;}
var fullData=merge(joinData,filterFootnotes);var nestyr=d3.nest().key(function(d){return d.year;}).sortKeys(d3.ascending).map(filtered);var yearstring=Object.keys(nestyr);var arrTemp=Object.keys(nestyr);if(yearstring.length!=1){yearstring=[];for(i=0;i<arrTemp.length;i++){yearstring.push(arrTemp[i]);yearstring.push('f'+arrTemp[i]);}}else{yearstring.push('f'+yearstring);}
minyear1=+d3.min(yearstring);maxyear1=+d3.max(yearstring);var width=200,height=25;var minInd=d3.min(filtered,function(d){return d.value;})
var maxInd=d3.max(filtered,function(d){return d.value;})
yearstring.push('f'+yearstring);var tableData=[],countries={};var arrFootnoteKeys=[];fullData.forEach(function(d){var country=countries[d.country];if(!country){tableData.push(country=countries[d.country]={});}
if(d.footnote_id){var temp=null;var temp2=null;filterFootnotes.forEach(function(f){if(f.iso3==d.iso3&&f.year==d.year){if(added.indexOf(f.footnote_id)==-1){count=count+1;arrFootnoteKeys.push(f.footnote_id);}
if(temp2!=null){temp2=temp2+","+arrAlpha[arrFootnoteKeys.indexOf(f.footnote_id)];var arr=temp2.split(",").sort();country[d.year]=d.value;country['f'+d.year]="<sup class='footnote' data-toggle=\"tooltip\" title=\""+temp2+": "+definitions[d.footnote_id]+"\">"+"<a href=\"#"+arrAlpha[arrFootnoteKeys.indexOf(f.footnote_id)]+"\"><span style=\"font-size:1.4em;vertical-align:text-top;\">"+arr+"</span></a></sup>";}else{temp2=arrAlpha[arrFootnoteKeys.indexOf(f.footnote_id)];country[d.year]=d.value;country['f'+d.year]="<sup class='footnote' data-toggle=\"tooltip\" title=\""+temp2+": "+definitions[d.footnote_id]+"\">"+"<a href=\"#"+arrAlpha[arrFootnoteKeys.indexOf(f.footnote_id)]+"\"><span style=\"font-size:1.4em;vertical-align:text-top;\">"+temp2+"</span></a></sup>";}
if(added.indexOf(f.footnote_id)==-1){countries[d.country]['footnote']=f.footnote_id;if(undefined!=definitions[f.footnote_id]){notes+="<a name=\""+arrAlpha[arrFootnoteKeys.indexOf(f.footnote_id)]+"\"></a>"+arrAlpha[arrFootnoteKeys.indexOf(f.footnote_id)]+": "+definitions[f.footnote_id]+"<br>";added.push(f.footnote_id);}}}});}else{country[d.year]=d.value;}
countries[d.country]['HDI Rank']=d.rank,countries[d.country].Country="<img src='/sites/default/files/Country-Profiles/"+d.iso3+".GIF' style='width:20px; height:auto;'> "+"<a href='/countries/profiles/"+d.iso3+"'>"+d.country+"</a>";});tableData.forEach(function(d){if(tableData.indexOf(15711)>-1){return true;}
else{return false;}});yearstring.unshift("Country");yearstring.unshift("HDI Rank");updateGraph(data);if(yearstring.length>0){yearstring.pop();}
tabulate(tableData,yearstring);$("#indcontent").append(notes);});});});});function updateGraph(data){var nestyr=d3.nest().key(function(d){return d.year;}).sortKeys(d3.ascending).map(filtered);var yearstring=Object.keys(nestyr);minyear=+d3.min(yearstring);maxyear=+d3.max(yearstring);filterMaxYear=filterJSON(filtered,'year',maxyear);filterMaxYear.forEach(function(d){d.id=+d.id;d.year=+d.year;d.value=+d.value;newDict[d.iso3]=+d.value;interval=d.interval;});var nestfilt=d3.nest().key(function(d){return d.country;}).sortKeys(d3.ascending).map(filtered);var nestiso=d3.nest().key(function(d){return d.iso3;}).sortKeys(d3.ascending).map(filtered);var minValue=+d3.min(filterMaxYear,function(d,filterMaxYear){return d.value;});var maxValue=+d3.max(filterMaxYear,function(d,filterMaxYear){return d.value;});var mapper=filterMaxYear.map(function(d){return d.value;}).sort(function(a,b){return a-b;});var quantile=d3.scale.quantile().domain(mapper).range(["chorlow","chormed","chormedhigh","chorhigh"]);d3.json("/sites/all/themes/hdr_theme/js/summary.json",function(info){summary=filterJSON(info,'id',currentIndicator);summary.forEach(function(d){jQuery('h1.page-header').html(d.indicator);var txtSDG=null;if(d.dimension.length>0){txtSDG=d.sdg;jQuery('h3.page-subheader').html(txtSDG);}});var head=d3.select('#header').selectAll("div").data(summary).enter().append("div").html(function(d){var dim="";if(d.dimension.length>0){dim="Dimension: "+d.dimension;}var txtSource="";if(d.source.length>0){txtSource=d.definition+"<br/><span class='source'>Source: "+d.source+"</span>";}return dim+"<br><br>"+txtSource;});});};function tabulate(newData,columns){var table=d3.select('#indcontent').append('table').attr("id","table");var thead=table.append('thead');var tbody=table.append('tbody');var headerName=thead.append('tr').selectAll('th').data(indName);headerName.enter().append('th').text(indicatorName).attr("class","indName");var headerRow=thead.append('tr').selectAll('th').data(columns);headerRow.enter().append('th').text(function(column){if(column==9999){return interval;}else if(column.charAt(0)!='f'){return column;}else{return "";}}).attr("style","width:auto;");var rows=tbody.selectAll('tr').data(newData).enter().append('tr');rows.attr("class",function(d,i){if(i++%2===0){return 'row-even'}else{return 'row-odd'}});if(notes!=undefined){var arrNotes=notes.split("<br>");for(var i=0;i<arrNotes.length;i++){var fnotes=tbody.append('tr').selectAll('td').data(fonotes);fnotes.enter().append('td').text(arrNotes[i].replace(/<a name=\"[a-z]\"><\/a>/g,"").replace(/<br>/g,"")).attr("class","footnotestable");}};var cells=rows.selectAll('td').data(function(row){return columns.map(function(column){return{column:column,value:row[column]};});});cells.enter().append('td').attr("class",function(d){return d.year;}).html(function(d){if(d.value=='NaN'){return "";}else{return d.value;}});$("#table tr td:contains('undefined ')").parent().remove();$("#table tr td:contains('undefined')").parent().remove();return table;};jQuery(document).ready(function($){if(isIE8){$('body').addClass('ie8');}
var gap=($('body').width()-$('#map').width())/2;});$(document).ready(function(){function exportTableToCSV($table){var $rows=$table.find('tr:has(td),tr:has(th)');var tmpColDelim=String.fromCharCode(11),tmpRowDelim=String.fromCharCode(0),colDelim='","',rowDelim='"\r\n"',csv='"'+$rows.map(function(i,row){var $row=$(row),$cols=$row.find('td,th');return $cols.map(function(j,col){var $col=$(col),text=$col.text();return text.replace(/"/g,'""');}).get().join(tmpColDelim);}).get().join(tmpRowDelim).split(tmpRowDelim).join(rowDelim).split(tmpColDelim).join(colDelim)+'"';textEncoder=new CustomTextEncoder('windows-1252',{NONSTANDARD_allowLegacyEncoding:true}),fileName=indicatorName+'.csv';var csvContentEncoded=textEncoder.encode([csv]);var blob=new Blob([csvContentEncoded],{type:'text/csv;charset=windows-1252;'});saveAs(blob,fileName);}
$(".export").on('click',function(event){exportTableToCSV.apply(this,[$('#indcontent>table')]);});});